"use strict";const t=require("../../common/vendor.js"),e=require("../../utils/request.js"),i=require("../../utils/tool.js"),a={data:()=>({detail:{title:"xxxx",author:"xxxx",posttime:13413412341,content:"xxxxx",contentStatus:!1,loadFailedPicUrl:"../../static/img/loadFailed.png"}}),methods:{getNewsDetail(a){e.API.get("/dataApi/news/detail.php",a).then((e=>{e.id?(e.content=e.content.replace(/<img/gi,'<img style="max-width:100%;border-radius:5px"'),e.posttime=i.timestampFormat(e.posttime),this.detail=e,this.saveHistory(),t.index.setNavigationBarTitle({title:this.detail.title})):this.contentStatus=!0})).catch((t=>{this.contentStatus=!0}))},saveHistory(){let e=t.index.getStorageSync("historyArr")||[],a={id:this.detail.id,classid:this.detail.classid,picurl:this.detail.picurl,title:this.detail.title,author:this.detail.author,hits:this.detail.hits,looktime:i.timestampFormat(Date.now()/1e3)},s=e.findIndex((t=>t.id==this.detail.id));s>=0&&e.splice(s,1),e.unshift(a),e=e.slice(0,10),t.index.setStorageSync("historyArr",e)}},onLoad(t){this.getNewsDetail(t)}};const s=t._export_sfc(a,[["render",function(e,i,a,s,l,o){return t.e({a:t.t(l.detail.title),b:t.t(l.detail.author),c:t.t(l.detail.posttime),d:l.detail.content,e:e.contentStatus},e.contentStatus?{f:e.loadFailedPicUrl}:{})}]]);wx.createPage(s);
